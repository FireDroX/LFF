{"version":3,"file":"static/js/290.0bf5a1fe.chunk.js","mappings":"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","sources":["components/Dropdown/Dropdown.jsx","pages/dashboard/Dashboard.jsx","utils/pointOptions.js"],"sourcesContent":["import { useState } from \"react\";\nimport \"./Dropdown.css\";\n\nconst Dropdown = ({ types, items, onSelect }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [selected, setSelected] = useState(null);\n\n  const handleSelect = (item) => {\n    setSelected(item);\n    onSelect(item.label.toLowerCase());\n    setIsOpen(false);\n  };\n\n  return (\n    <div className=\"dropdown\">\n      <button\n        type=\"button\"\n        className=\"dropdown-toggle\"\n        onClick={() => setIsOpen((prev) => !prev)}\n      >\n        {selected ? (\n          <div className=\"dropdown-selected\">\n            <img src={selected.icon} alt={selected.label} />\n            <span>{selected.label}</span>\n          </div>\n        ) : (\n          <span>Sélectionner un classement</span>\n        )}\n      </button>\n\n      {isOpen && (\n        <ul className=\"dropdown-menu\">\n          {types.map((type, i) => {\n            const option = items[type] || {};\n\n            return (\n              <li\n                key={i}\n                className=\"dropdown-item\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  handleSelect(option, i);\n                }}\n              >\n                <img src={option.icon} alt={option.label} />\n                <span>{option.label}</span>\n              </li>\n            );\n          })}\n        </ul>\n      )}\n    </div>\n  );\n};\n\nexport default Dropdown;\n","import \"./Dashboard.css\";\nimport { useCallback, useEffect, useState } from \"react\";\n\nimport Dropdown from \"../../components/Dropdown/Dropdown.jsx\";\n\nimport { currentTop, updatePoints } from \"../../utils/requests.js\";\nimport { WEEKLY_OPTIONS, ISVALUE_OPTIONS } from \"../../utils/pointOptions\";\nimport { formatNumberWithSpaces, formatDateShort } from \"../../utils/functions\";\n\nconst STAFF_TYPES = [\"crystaux\", \"iscoin\", \"dragonegg\", \"beacon\", \"sponge\"];\nconst POINT_OPTIONS = {\n  ...WEEKLY_OPTIONS,\n  ...ISVALUE_OPTIONS,\n};\n\nconst EMPTY_FORM = {\n  selectedUserKey: \"\",\n  username: \"\",\n  userId: \"\",\n  points: \"\",\n};\n\nconst buildInitialFormsState = () =>\n  STAFF_TYPES.reduce((acc, type) => {\n    acc[type] = { ...EMPTY_FORM };\n    return acc;\n  }, {});\n\nconst Dashboard = ({ isLogged, isAdmin }) => {\n  const isStaff = isLogged && isAdmin;\n\n  const [leaderboards, setLeaderboards] = useState({});\n  const [forms, setForms] = useState(() => buildInitialFormsState());\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [submitting, setSubmitting] = useState(null);\n  const [selectedType, setSelectedType] = useState(\"crystaux\");\n\n  const resetForm = (type) => {\n    setForms((prev) => ({\n      ...prev,\n      [type]: { ...EMPTY_FORM },\n    }));\n  };\n\n  const updateForm = (type, patch) => {\n    setForms((prev) => ({\n      ...prev,\n      [type]: {\n        ...(prev[type] || { ...EMPTY_FORM }),\n        ...patch,\n      },\n    }));\n  };\n\n  const loadLeaderboards = useCallback(() => {\n    setLoading(true);\n    Promise.all(\n      STAFF_TYPES.map((type) =>\n        currentTop(type)\n          .then((data) => {\n            if (data?.error) throw new Error(data.error);\n            return [type, data];\n          })\n          .catch((err) => {\n            console.error(`Failed to load leaderboard ${type}`, err);\n            return [type, null];\n          })\n      )\n    )\n      .then((entries) => {\n        const mapped = {};\n        let hasFailure = false;\n\n        entries.forEach(([type, data]) => {\n          if (!data) {\n            hasFailure = true;\n            return;\n          }\n          mapped[type] = data;\n        });\n\n        setLeaderboards(mapped);\n        setError(\n          hasFailure\n            ? \"Certaines données n'ont pas pu être chargées. Réessayez.\"\n            : \"\"\n        );\n      })\n      .catch((err) => {\n        console.error(\"Failed to load staff leaderboards\", err);\n        setError(\"Impossible de charger les classements pour le moment.\");\n      })\n      .finally(() => setLoading(false));\n  }, []);\n\n  useEffect(() => {\n    if (isStaff) {\n      loadLeaderboards();\n    } else {\n      setLeaderboards({});\n      setError(\"\");\n      setLoading(false);\n    }\n  }, [isStaff, loadLeaderboards]);\n\n  const handleSelectUser = (type, value) => {\n    if (!value) {\n      resetForm(type);\n      return;\n    }\n\n    const users = leaderboards[type]?.users || [];\n    let selectedUser = null;\n\n    if (value.startsWith(\"id:\")) {\n      const id = value.slice(3);\n      selectedUser = users.find(\n        (user) => user.userId && String(user.userId) === id\n      );\n    } else if (value.startsWith(\"idx:\")) {\n      const index = Number(value.slice(4));\n      if (!Number.isNaN(index) && users[index]) {\n        selectedUser = users[index];\n      }\n    }\n\n    if (selectedUser) {\n      updateForm(type, {\n        selectedUserKey: value,\n        username: selectedUser.name || \"\",\n        userId: selectedUser.userId ? String(selectedUser.userId) : \"\",\n      });\n    } else {\n      updateForm(type, { selectedUserKey: value });\n    }\n  };\n\n  const submitChange = async (type, direction) => {\n    const form = forms[type] || { ...EMPTY_FORM };\n    const amount = Number(form.points);\n\n    if (!amount || amount <= 0) {\n      setError(\"Veuillez indiquer un nombre de points strictement positif.\");\n      return;\n    }\n\n    if (!form.username && !form.userId) {\n      setError(\n        \"Un nom d'utilisateur ou un identifiant Discord est requis pour continuer.\"\n      );\n      return;\n    }\n\n    try {\n      setSubmitting(type);\n      setError(\"\");\n\n      const payload = {\n        delta: direction === \"add\" ? amount : -amount,\n        username: form.username || undefined,\n        userId: form.userId ? String(form.userId) : undefined,\n      };\n\n      const updated = await updatePoints(type, payload);\n      if (updated?.error) {\n        throw new Error(updated.error);\n      }\n\n      setLeaderboards((prev) => ({\n        ...prev,\n        [type]: {\n          ...(prev[type] || {}),\n          ...updated,\n        },\n      }));\n      resetForm(type);\n    } catch (err) {\n      console.error(\"Staff update failed\", err);\n      setError(\n        err?.message || \"Impossible de mettre à jour le classement. Réessayez.\"\n      );\n    } finally {\n      setSubmitting(null);\n    }\n  };\n\n  const renderLeaderboardRows = (users = []) => {\n    if (!Array.isArray(users) || users.length === 0) {\n      return (\n        <tr>\n          <td colSpan=\"4\" className=\"staff-empty\">\n            Aucun joueur pour le moment.\n          </td>\n        </tr>\n      );\n    }\n\n    return users.map((user, index) => (\n      <tr key={`${user.userId || user.name || index}-${index}`}>\n        <td>{index + 1}</td>\n        <td>{user.name || \"Sans nom\"}</td>\n        <td>{formatNumberWithSpaces(user.score || 0)}</td>\n        <td>{user.userId || \"—\"}</td>\n      </tr>\n    ));\n  };\n\n  if (!isStaff) {\n    return (\n      <section className=\"App\">\n        <div className=\"staff-dashboard staff-dashboard--center\">\n          <div className=\"staff-card\">\n            <h3>Accès refusé</h3>\n            <p>\n              Ce tableau de bord est réservé aux membres du staff habilités.\n            </p>\n          </div>\n        </div>\n      </section>\n    );\n  }\n\n  return (\n    <section className=\"App\">\n      <div className=\"staff-dashboard\">\n        <div className=\"staff-dashboard-header\">\n          <Dropdown\n            types={STAFF_TYPES}\n            items={POINT_OPTIONS}\n            onSelect={setSelectedType}\n          />\n\n          <button\n            className=\"staff-refresh\"\n            onClick={loadLeaderboards}\n            disabled={loading || submitting !== null}\n          >\n            Recharger\n          </button>\n        </div>\n\n        {error && <div className=\"staff-error\">{error}</div>}\n\n        {loading ? (\n          <div className=\"spinner-container\">\n            <div className=\"spinner\" aria-hidden=\"true\"></div>\n          </div>\n        ) : (\n          <div className=\"staff-grid\">\n            {(selectedType ? [selectedType] : STAFF_TYPES).map((type) => {\n              const option = POINT_OPTIONS[type] || {};\n              const board = leaderboards[type] || {};\n              const users = board.users || [];\n              const form = forms[type] || { ...EMPTY_FORM };\n              const disabled = submitting === type;\n              const hasDates = board.start && board.end;\n\n              return (\n                <div className=\"staff-card\" key={type}>\n                  <div className=\"staff-card-header\">\n                    <div className=\"staff-card-title\">\n                      <h3>{option.label || type}</h3>\n                      {option.icon && (\n                        <img\n                          src={option.icon}\n                          alt={option.label || type}\n                          className=\"staff-card-icon\"\n                        />\n                      )}\n                    </div>\n                    {hasDates && (\n                      <span className=\"staff-period\">\n                        {formatDateShort(board.start)} -{\" \"}\n                        {formatDateShort(board.end)}\n                      </span>\n                    )}\n                  </div>\n\n                  <div className=\"staff-table-wrapper\">\n                    <table className=\"staff-table\">\n                      <thead>\n                        <tr>\n                          <th>#</th>\n                          <th>Joueur</th>\n                          <th>Points</th>\n                          <th>Discord ID</th>\n                        </tr>\n                      </thead>\n                      <tbody>{renderLeaderboardRows(users)}</tbody>\n                    </table>\n                  </div>\n\n                  <div className=\"staff-form\">\n                    <label>\n                      Joueur existant\n                      <select\n                        value={form.selectedUserKey}\n                        onChange={(event) =>\n                          handleSelectUser(type, event.target.value)\n                        }\n                      >\n                        <option value=\"\">-- Nouveau membre --</option>\n                        {users.map((user, index) => {\n                          const value = user.userId\n                            ? `id:${user.userId}`\n                            : `idx:${index}`;\n                          return (\n                            <option key={value} value={value}>\n                              {user.name || \"Sans nom\"} (\n                              {formatNumberWithSpaces(user.score || 0)} pts)\n                            </option>\n                          );\n                        })}\n                      </select>\n                    </label>\n\n                    <label>\n                      Nom d'affichage\n                      <input\n                        type=\"text\"\n                        placeholder=\"Nom du joueur\"\n                        value={form.username}\n                        onChange={(event) =>\n                          updateForm(type, {\n                            username: event.target.value,\n                          })\n                        }\n                      />\n                    </label>\n\n                    <label>\n                      Discord ID (optionnel)\n                      <input\n                        type=\"text\"\n                        placeholder=\"Identifiant numérique\"\n                        value={form.userId}\n                        onChange={(event) =>\n                          updateForm(type, {\n                            userId: event.target.value.trim(),\n                          })\n                        }\n                      />\n                    </label>\n\n                    <label>\n                      Points\n                      <input\n                        type=\"number\"\n                        min=\"1\"\n                        max=\"1000000\"\n                        value={form.points}\n                        onChange={(event) =>\n                          updateForm(type, {\n                            points: event.target.value,\n                          })\n                        }\n                      />\n                    </label>\n\n                    <div className=\"staff-form-actions\">\n                      <button\n                        type=\"button\"\n                        className=\"staff-button staff-button--add\"\n                        disabled={disabled}\n                        onClick={() => submitChange(type, \"add\")}\n                      >\n                        Ajouter\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"staff-button staff-button--remove\"\n                        disabled={disabled}\n                        onClick={() => submitChange(type, \"remove\")}\n                      >\n                        Retirer\n                      </button>\n                      <button\n                        type=\"button\"\n                        className=\"staff-button staff-button--reset\"\n                        disabled={disabled}\n                        onClick={() => resetForm(type)}\n                      >\n                        Vider\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </section>\n  );\n};\n\nexport default Dashboard;\n","import { formatNumberWithSpaces, compactNumber } from \"./functions\";\n\nimport crystaux from \"../assets/crystaux.webp\";\nimport iscoin from \"../assets/iscoin.webp\";\nimport dragon_egg from \"../assets/dragon_egg.webp\";\nimport beacon from \"../assets/beacon.webp\";\nimport sponge from \"../assets/sponge.webp\";\n\nexport const WEEKLY_OPTIONS = {\n  crystaux: {\n    multiplier: 100,\n    label: \"Crystaux\",\n    format: (p) =>\n      `${formatNumberWithSpaces(p)} = ${compactNumber(p * 100)} Crystaux`,\n    requiredAmount: 50,\n    icon: crystaux,\n  },\n  iscoin: {\n    multiplier: 2000000,\n    label: \"IsCoin\",\n    format: (p) =>\n      `${formatNumberWithSpaces(p)} = ${compactNumber(p * 2000000)} $`,\n    requiredAmount: 1000,\n    icon: iscoin,\n  },\n};\n\nexport const ISVALUE_OPTIONS = {\n  dragonegg: {\n    multiplier: 1500000000,\n    label: \"DragonEgg\",\n    format: (p) =>\n      `${formatNumberWithSpaces(p)} = ${compactNumber(p * 1500000000)} $`,\n    icon: dragon_egg,\n  },\n  beacon: {\n    multiplier: 150000000,\n    label: \"Beacon\",\n    format: (p) =>\n      `${formatNumberWithSpaces(p)} = ${compactNumber(p * 150000000)} $`,\n    icon: beacon,\n  },\n  sponge: {\n    multiplier: 15000000,\n    label: \"Sponge\",\n    format: (p) =>\n      `${formatNumberWithSpaces(p)} = ${compactNumber(p * 15000000)} $`,\n    icon: sponge,\n  },\n};\n"],"names":["_ref","types","items","onSelect","isOpen","setIsOpen","useState","selected","setSelected","_jsxs","className","children","_jsx","type","onClick","prev","src","icon","alt","label","map","i","option","e","item","preventDefault","toLowerCase","STAFF_TYPES","POINT_OPTIONS","_objectSpread","WEEKLY_OPTIONS","ISVALUE_OPTIONS","EMPTY_FORM","selectedUserKey","username","userId","points","isLogged","isAdmin","isStaff","leaderboards","setLeaderboards","forms","setForms","reduce","acc","loading","setLoading","error","setError","submitting","setSubmitting","selectedType","setSelectedType","resetForm","updateForm","patch","loadLeaderboards","useCallback","Promise","all","currentTop","then","data","Error","catch","err","console","concat","entries","mapped","hasFailure","forEach","_ref2","finally","useEffect","submitChange","async","direction","form","amount","Number","payload","delta","undefined","String","updated","updatePoints","message","renderLeaderboardRows","users","arguments","length","Array","isArray","user","index","name","formatNumberWithSpaces","score","colSpan","Dropdown","disabled","board","hasDates","start","end","formatDateShort","value","onChange","event","handleSelectUser","_leaderboards$type","selectedUser","startsWith","id","slice","find","isNaN","target","placeholder","trim","min","max","crystaux","multiplier","format","p","compactNumber","requiredAmount","iscoin","dragonegg","dragon_egg","beacon","sponge"],"sourceRoot":""}